# React Query in `shipwell/frontend-web`

---

## What we will cover

<Step styles={{
  before: {opacity: 0},
  after: {opacity: 1, transition: 'all 0.2s ease-out'},
}}
>

- What is React Query?
- What _isn't_ React Query?
- Query basics
- Mutation basics
- How React Query fits into `shipwell/frontend-web`

</Step>

---

## What is React Query?

![react query](./assets/react-query.svg)

From <https://react-query.tanstack.com/overview>:

<Block sx={{
  width: '50%'
}}>

> React Query is often described as the missing data-fetching library for React, but in more technical terms, it makes fetching, caching, synchronizing and updating server state in your React applications a breeze.

</Block>

---

## But what does that mean?

It replaces this

```js
import React, {useState, useCallback, useEffect} from 'react';
import { getShipment } from "App/api/shipments";

// …

const [shipmentDetailsResponse, setShipmentDetailsResponse] = useState();
const [isShipmentDetailsLoading, setIsShipmentDetailsLoading] = useState(false);

const fetchShipment = useCallback(
	async (id) => {
		setIsShipmentDetailsLoading(true);
		try {
			const response = await getShipment(id);
			setShipmentDetailsResponse(JSON.stringify(response.data, null, 2));
		} catch (error) {
			console.error(error);
			setError("Error retrieving shipment!", error.message);
		} finally {
			setIsShipmentDetailsLoading(false);
		}
	},
	[setError]
);

useEffect(() => {
	if (!shipmentDetailsResponse) {
		fetchShipment(shipmentId);
	}
}, [shipmentDetailsResponse]);
```

---

## But what does that mean?

With this

```js
import React from 'react';
import { getShipment } from "App/api/shipments";
import { useQuery } from "react-query";

// …

const fetchShipmentDetailsQuery = useQuery(["shipments", shipmentId], (id) => getShipment(id), {
	onError: (error) => {
		console.error(error);
		setError("Error retrieving shipment!", error.message);
	},
});
```
